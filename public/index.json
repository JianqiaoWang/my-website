[{"authors":null,"categories":null,"content":"I\u0026rsquo;m an Assistant Professor in the Department of Statistics and Data Science at the Tsinghua University.\nI got my Ph.D. in Biostatistics from the University of Pennsylvania, advised by Professor Hongzhe Li. After that, I was a postdoctoral scholar in the Biostatistics Department at Harvard T.H. Chan School of Public Health, advised by Professor Xihong Lin.\nMy research is dedicated to developing scalable and robust statistical methods for analyzing the high-dimensional genetic and genomic data.\n#  Download my CV.\n","date":1609459200,"expirydate":-62135596800,"kind":"term","lang":"en","lastmod":1642462549,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"https://academic-demo.netlify.app/author/jianqiao-wang/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/author/jianqiao-wang/","section":"authors","summary":"I\u0026rsquo;m an Assistant Professor in the Department of Statistics and Data Science at the Tsinghua University.\nI got my Ph.D. in Biostatistics from the University of Pennsylvania, advised by Professor Hongzhe Li.","tags":null,"title":"Jianqiao Wang","type":"authors"},{"authors":null,"categories":null,"content":"   Table of Contents  What you will learn Program overview Courses in this program Meet your instructor FAQs    What you will learn  Fundamental Python programming skills Statistical concepts and how to apply them in practice Gain experience with the Scikit, including data visualization with Plotly and data wrangling with Pandas  Program overview The demand for skilled data science practitioners is rapidly growing. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi.\nCourses in this program  Python basics Build a foundation in Python.   Visualization Learn how to visualize data with Plotly.   Statistics Introduction to statistics for data science.   Meet your instructor Jianqiao Wang FAQs Are there prerequisites? There are no prerequisites for the first course.\n How often do the courses run? Continuously, at your own pace.\n  Begin the course   ","date":1611446400,"expirydate":-62135596800,"kind":"section","lang":"en","lastmod":1611446400,"objectID":"59c3ce8e202293146a8a934d37a4070b","permalink":"https://academic-demo.netlify.app/courses/example/","publishdate":"2021-01-24T00:00:00Z","relpermalink":"/courses/example/","section":"courses","summary":"An example of using Wowchemy's Book layout for publishing online courses.","tags":null,"title":"📊 Learn Data Science","type":"book"},{"authors":null,"categories":null,"content":"Build a foundation in Python.\n  1-2 hours per week, for 8 weeks\nLearn   Quiz What is the difference between lists and tuples? Lists\n Lists are mutable - they can be changed Slower than tuples Syntax: a_list = [1, 2.0, 'Hello world']  Tuples\n Tuples are immutable - they can\u0026rsquo;t be changed Tuples are faster than lists Syntax: a_tuple = (1, 2.0, 'Hello world')   Is Python case-sensitive? Yes\n","date":1609459200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1609459200,"objectID":"17a31b92253d299002593b7491eedeea","permalink":"https://academic-demo.netlify.app/courses/example/python/","publishdate":"2021-01-01T00:00:00Z","relpermalink":"/courses/example/python/","section":"courses","summary":"Build a foundation in Python.\n","tags":null,"title":"Python basics","type":"book"},{"authors":null,"categories":null,"content":"Learn how to visualize data with Plotly.\n  1-2 hours per week, for 8 weeks\nLearn   Quiz When is a heatmap useful? Lorem ipsum dolor sit amet, consectetur adipiscing elit.\n Write Plotly code to render a bar chart import plotly.express as px data_canada = px.data.gapminder().query(\u0026quot;country == 'Canada'\u0026quot;) fig = px.bar(data_canada, x='year', y='pop') fig.show()  ","date":1609459200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1609459200,"objectID":"1b341b3479c8c6b1f807553b77e21b7c","permalink":"https://academic-demo.netlify.app/courses/example/visualization/","publishdate":"2021-01-01T00:00:00Z","relpermalink":"/courses/example/visualization/","section":"courses","summary":"Learn how to visualize data with Plotly.\n","tags":null,"title":"Visualization","type":"book"},{"authors":null,"categories":null,"content":"Introduction to statistics for data science.\n  1-2 hours per week, for 8 weeks\nLearn The general form of the normal probability density function is:\n$$ f(x) = \\frac{1}{\\sigma \\sqrt{2\\pi} } e^{-\\frac{1}{2}\\left(\\frac{x-\\mu}{\\sigma}\\right)^2} $$\n The parameter $\\mu$ is the mean or expectation of the distribution. $\\sigma$ is its standard deviation. The variance of the distribution is $\\sigma^{2}$.   Quiz What is the parameter $\\mu$? The parameter $\\mu$ is the mean or expectation of the distribution.\n","date":1609459200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1609459200,"objectID":"6f4078728d71b1b791d39f218bf2bdb1","permalink":"https://academic-demo.netlify.app/courses/example/stats/","publishdate":"2021-01-01T00:00:00Z","relpermalink":"/courses/example/stats/","section":"courses","summary":"Introduction to statistics for data science.\n","tags":null,"title":"Statistics","type":"book"},{"authors":[],"categories":null,"content":" Click on the Slides button above to view the built-in slides feature.   Slides can be added in a few ways:\n Create slides using Wowchemy\u0026rsquo;s Slides feature and link using slides parameter in the front matter of the talk file Upload an existing slide deck to static/ and link using url_slides parameter in the front matter of the talk file Embed your slides (e.g. Google Slides) or presentation video on this page using shortcodes.  Further event details, including page elements such as image galleries, can be added to the body of this page.\n","date":1906549200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1906549200,"objectID":"a8edef490afe42206247b6ac05657af0","permalink":"https://academic-demo.netlify.app/talk/example-talk/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/talk/example-talk/","section":"event","summary":"An example talk using Wowchemy's Markdown slides feature.","tags":[],"title":"Example Talk","type":"event"},{"authors":["Jianqiao Wang","Sai Li","Hongzhe Li"],"categories":[],"content":"","date":1672531200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1672531200,"objectID":"eb36d03ad7d5766af9ef0c61f9a14391","permalink":"https://academic-demo.netlify.app/publication/wang-2021-unified/","publishdate":"2023-01-01T00:00:00Z","relpermalink":"/publication/wang-2021-unified/","section":"publication","summary":"","tags":[],"title":"A Regression-based Approach to Robust Estimation and Inference for Genetic Covariance","type":"publication"},{"authors":["Zhen Miao","Jianqiao Wang","Kernyu Park","Da Kuang","Junhyong Kim"],"categories":[],"content":"","date":1672531200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1672531200,"objectID":"0fe6e389ff92c0502d38d563a3213902","permalink":"https://academic-demo.netlify.app/publication/miao2023model/","publishdate":"2023-01-01T00:00:00Z","relpermalink":"/publication/miao2023model/","section":"publication","summary":"","tags":[],"title":"Model-based compound hypothesis testing for snATAC-seq data with PACS","type":"publication"},{"authors":["Rajat Deo","Ruth F Dubin","Yue Ren","Ashwin C Murthy","Jianqiao Wang","Haotian Zheng","Zihe Zheng","Harold Feldman","Haochang Shou","Josef Coresh","others"],"categories":[],"content":"","date":1672531200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1672531200,"objectID":"6f82da21ff23642097e47ff0c5d49fc7","permalink":"https://academic-demo.netlify.app/publication/deo2023proteomic/","publishdate":"2023-01-01T00:00:00Z","relpermalink":"/publication/deo2023proteomic/","section":"publication","summary":"","tags":[],"title":"Proteomic cardiovascular risk assessment in chronic kidney disease","type":"publication"},{"authors":["Ruth Dubin","Rajat Deo","Yue Ren","Jianqiao Wang","Zihe Zheng","Haochang Shou","Alan Go","Afshin Parsa","James Lash","Mahboob Rahman","Chi-yuan Hsu","Matthew Weir","Jing Chen","Amanda Anderson","Morgan Grams","Aditya Surapaneni","Josef Coresh","Hongzhe Lee","Paul Kimmel","Ramachandran Vasan","Harold Feldman","Mark Segal","Peter Ganz"],"categories":null,"content":"","date":1672531200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1672531200,"objectID":"302b63e26fd6cacb3b461d60ed162b5f","permalink":"https://academic-demo.netlify.app/publication/dubin2023proteomics/","publishdate":"2023-01-01T00:00:00Z","relpermalink":"/publication/dubin2023proteomics/","section":"publication","summary":"","tags":null,"title":"Proteomics of CKD Progression in the Chronic Renal Insufficiency Cohort","type":"publication"},{"authors":["Jianqiao Wang","Hongzhe Li"],"categories":[],"content":"","date":1640995200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1642462540,"objectID":"b2abd303bebb93f0b6e7bf1ea466316b","permalink":"https://academic-demo.netlify.app/publication/wang-2021-estimation/","publishdate":"2022-01-18T03:24:57.275986Z","relpermalink":"/publication/wang-2021-estimation/","section":"publication","summary":"","tags":[],"title":"Estimation of genetic correlation with summary association statistics","type":"publication"},{"authors":["Jianqiao Wang","Wanjie Wang","Hongzhe Li"],"categories":[],"content":"","date":1640995200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1642462546,"objectID":"7569fda984da08d5d21759563808b38a","permalink":"https://academic-demo.netlify.app/publication/wangsparse/","publishdate":"2022-01-18T03:25:09.206524Z","relpermalink":"/publication/wangsparse/","section":"publication","summary":"","tags":[],"title":"Sparse Block Signal Detection and Identification for Shared Cross-Trait Association Analysis","type":"publication"},{"authors":[],"categories":[],"content":"Introduction The reference genotype database has been widely used for GWA studieds. It provides more information on the genetic variants when the individual-level genotype data is not available or the genotypes data has low sequencing depth. The reference also has been used for imputing the missing genotypes to boost the power of GWAS.\nCommon reference panels include:\n HapMap3 reference panels: Early reference panels 1000 Genomes Phase3 (1KGP, widely used), 2506 individuals from 26 populations, 49,143,605 Sites. 504 individuals for European ancestry. The Haplotype Reference Consortium (HRC), the first release consists of 64,976 haplotypes at 39,235,157 SNPs. Mainly european ancestry but also includes 1KGP Topmed reference panel. Version r2 of the panel includes 97,256 reference samples and 308,107,085 genetic variants distributed across the 22 autosomes and the X chromosome.  Not all reference panels are public. Large reference needs some applications . Here we focus on working with 1KGP reference panel.\nWork with 1KGP access to the 1KGP project data  Raw genotype varaint call files (vcf) could be downloaded from http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/ at each chromosome. However, we remind the loci of variants were determined for version GRCh37.  Variants on GRCh38 should check the information about the data collection at : https://www.internationalgenome.org/data-portal/data-collection/30x-grch38. It contains 2504 unrelated individuals and additional 698 related samples with high coverage.    To convert them to the plink file, we need to run following commands:\nfor j in {1..22}; do wget ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/ALL.chr$j.phase3_shapeit2_mvncall_integrated_v5a.20130502.genotypes.vcf.gz ./plink --make-bed --out chr$j --maf 0.01 --vcf ALL.chr$j.phase3_shapeit2_mvncall_integrated_v5a.20130502.genotypes.vcf.gz done   The plink file format of 1KGP could be found in https://www.coggenomics.org/plink/2.0/resources#1kg_phase3 in all_phase3.pgen, .psam, .pvar format  plink2 --pfile all_phase3 --pgen-info # check the information # or use the following command if all_phase3 is zst compressed plink2 --pfile all_phase3 vzs --pgen-info # check the information  The output is the information of the genotypes\n--pgen-info on all_phase3.pgen: Variants: 84805772 Samples: 2504 REF alleles are all known Maximum allele count for a single variant: \u0026gt;2, not explicitly stored Explicitly phased hardcalls present No dosages present  Then we extract the European indviduals with maf \u0026gt; 0.01 amd remove snps with multi allels, duplicate posisions and names\nplink2 --pfile all_phase3 'vzs' --keep-if SuperPop == EUR --rm-dup exclude-all --snps-only 'just-acgt' --max-alleles 2 --chr 1-22 --maf 0.01 --make-bed --out all_phase3_eur_maf_0.01  2504 samples (1271 females, 1233 males; 2497 founders) loaded from all_phase3.psam. 77818345 out of 84805772 variants loaded from all_phase3.pvar.zst. 2 categorical phenotypes loaded. --rm-dup: 191 duplicated IDs, 382 variants removed. --keep-if: 2001 samples removed. 503 samples (263 females, 240 males; 503 founders) remaining after main filters. Calculating allele frequencies... done. 69267844 variants removed due to allele frequency threshold(s) (--maf/--max-maf/--mac/--max-mac). 8550119 variants remaining after main filters.  Download and insert genetic distances\nplink --bfile all_phase3_eur_maf_0.01 --cm-map ./genetic_map/genetic_map_chr@_combined_b37.txt --make-bed --out all_phase3_eur_maf_0.01_ctm  Replace predictor names with generic names of the form Chr:BP (often not required, but I find this format more convenient). It is useful to create a file containing the original names, generic names and alleles.\ngenofile='all_phase3_eur_maf_0.01' awk \u0026lt; ${genofile}_ctm.bim '{$2=$1\u0026quot;:\u0026quot;$4;print $0}' \u0026gt; ${genofile}_ref.bim awk \u0026lt; ${genofile}_ctm.bim '{print $2, $1\u0026quot;:\u0026quot;$4, $5, $6}' \u0026gt; ${genofile}_ref.names cp ${genofile}_ctm.bed ${genofile}_ref.bed cp ${genofile}_ctm.fam ${genofile}_ref.fam  Then we remove the intermediate results and keep the ${genofile}_ref files as our reference panel.\nReference\n  https://dougspeed.com/reference-panel/\n  https://www.cog-genomics.org/plink/2.0/filter\n  A helpful tool for analyzing the GWAS data: plinkQC (Discussed later)\n  ","date":1637971200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1638053844,"objectID":"9f51e2635a09df0fb3c0a5024ca7442e","permalink":"https://academic-demo.netlify.app/post/working-with-the-reference-genotype-data/","publishdate":"2021-11-27T00:00:00Z","relpermalink":"/post/working-with-the-reference-genotype-data/","section":"post","summary":"Introduction The reference genotype database has been widely used for GWA studieds. It provides more information on the genetic variants when the individual-level genotype data is not available or the genotypes data has low sequencing depth.","tags":[],"title":"Working with the reference genotype data","type":"post"},{"authors":[],"categories":[],"content":"Working with the summary association statistics has been important in current GWAS studies. However, generated from different cohorts, the format of summary association statistics varies a lot. In this post, we discuss how to do the preprocessing for summary association statistics.\nUseful links\n https://dougspeed.com/summary-statistics/   ","date":1637971200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1638053889,"objectID":"66573e16d7df2d42bf1d4dca715f17c4","permalink":"https://academic-demo.netlify.app/post/working-with-the-summary-association-statistics/","publishdate":"2021-11-27T00:00:00Z","relpermalink":"/post/working-with-the-summary-association-statistics/","section":"post","summary":"Working with the summary association statistics has been important in current GWAS studies. However, generated from different cohorts, the format of summary association statistics varies a lot. In this post, we discuss how to do the preprocessing for summary association statistics.","tags":[],"title":"Working with the summary association statistics","type":"post"},{"authors":[],"categories":[],"content":"To do simulation with genetic data, we need to make some preparion. First, we detemine the snplist and individuals in the genotype data:\nsnplist.txt\nPrepare data for package bigsnpr and bigstatsr\nlibrary(bigsnpr) library(bigstatsr) PrepareX = FALSE #------------------------------------------------------- if(PrepareX){ rds = bigsnpr::snp_readBed2(bedfile = \u0026quot;../../Cric_HF_RealData/rawdata/cric.filtered.maf0.01.bed\u0026quot;, backingfile = \u0026quot;cric_geno\u0026quot;,ind.col= ind.column) geno \u0026lt;- snp_attach(rds) G \u0026lt;- geno$genotypes CHR \u0026lt;- geno$map$chromosome infos \u0026lt;- snp_fastImputeSimple(G, method = \u0026quot;mean2\u0026quot;) # To make this permanent, you need to save (modify) the file on disk geno$genotypes \u0026lt;- infos geno \u0026lt;- snp_save(geno) G \u0026lt;- geno$genotypes ind.keep \u0026lt;- snp_clumping(G, infos.chr = geno$map$chromosome, infos.pos = geno$map$physical.pos, thr.r2 = 0.01) saveRDS(ind.keep, file =\u0026quot;ind_keep_clump.rds\u0026quot;) data.table::fwrite( as.data.frame(geno$map$marker.ID), file = \u0026quot;snplist.txt\u0026quot;) }  Prepare for the GCTA method\nref.bed = \u0026quot;../../Cric_HF_RealData/rawdata/cric.filtered.maf0.01\u0026quot; MakeGRM = function(ref.bed, keep.snp, keep.ind, output.dir = \u0026quot;./temp/\u0026quot;){ grm = paste0(output.dir, \u0026quot;geno\u0026quot;) fwrite(data.frame(keep.snp), file = paste0(output.dir,\u0026quot;snplist.txt\u0026quot;), quote = F, sep = \u0026quot;\\t\u0026quot;, col.names=T, na = \u0026quot;NA\u0026quot;) system(paste0(\u0026quot;plink --bfile \u0026quot;, ref.bed, \u0026quot; --extract \u0026quot;, paste0(output.dir, \u0026quot;snplist.txt\u0026quot;), \u0026quot; --make-grm-bin --out \u0026quot;, grm ) ) } # alternative, slower #system(paste0(\u0026quot;./gcta64 --bfile \u0026quot;, ref.bed, \u0026quot; --extract \u0026quot;, paste0(output.dir, \u0026quot;snplist.txt\u0026quot;), \u0026quot; --make-grm-bin --out \u0026quot;, grm #) )  Prepare for the LD Score regression : Calculate the ld score\nSystem(\u0026quot;ldsc.py --bfile ../../Cric_HF_RealData/rawdata/cric.filtered.maf0.01 --extract ./temp/snplist.txt --ld-wind-kb 1000 --out ./temp/geno\u0026quot;)  ","date":1637798400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1637875075,"objectID":"54dceb613e2beb81664e063ff18e09f7","permalink":"https://academic-demo.netlify.app/post/step-0-preparation-for-the-genomic-simulation/","publishdate":"2021-11-25T00:00:00Z","relpermalink":"/post/step-0-preparation-for-the-genomic-simulation/","section":"post","summary":"To do simulation with genetic data, we need to make some preparion. First, we detemine the snplist and individuals in the genotype data:\nsnplist.txt\nPrepare data for package bigsnpr and bigstatsr","tags":[],"title":"Step 0: Preparation for the genomic simulation","type":"post"},{"authors":[],"categories":[],"content":"My dissertation research always needs to do comparison with the GCTA-GREML and LDSC.Here is an introduction of R analysis with LDSC and GCTA\nGCTA GCTA is a wonderful software designed for the dealing with the GWAS data. On the other hand, it does not always fit in the common statistical simulation pipeline, particualy for the software R. This post is used to document how to do statistical simulation with R and GCTA based on a give genotype file.\nWhat we need:\n phenotype file Y1, Y2 Genotype file geno.bed  First, we generate the GRM file based on the genotype file. This function only need be estimated once\nMakeGRM = function(ref.bed, keep.snp, keep.ind, output.dir = \u0026quot;./temp/\u0026quot;){\rgrm = paste0(output.dir, \u0026quot;geno\u0026quot;)\rfwrite(data.frame(keep.snp), file = paste0(output.dir,\u0026quot;snplist.txt\u0026quot;), quote = F, sep = \u0026quot;\\t\u0026quot;, col.names=T, na = \u0026quot;NA\u0026quot;)\rsystem(paste0(\u0026quot;plink --bfile \u0026quot;, ref.bed, \u0026quot; --extract \u0026quot;, paste0(output.dir, \u0026quot;snplist.txt\u0026quot;), \u0026quot; --make-grm-bin --out \u0026quot;, grm ) )\r}\r In the second step, we need to write out the phenotype file based on the FID and IID\nWritePheno = function( Y1, Y2, FID, IID, pheno.file ){\rpheno = data.frame(FID = FID, IID = IID,\rY1 = Y1, Y2 = Y2)\rfwrite(pheno, file = pheno.file,\rquote = F, sep = \u0026quot;\\t\u0026quot;, col.names=T, na = \u0026quot;NA\u0026quot;)\r}\r Then we implement the GCTA,\nSimuGCTA = function(geno.file, pheno.file, output.dir){\routput.file = paste0(output.dir, \u0026quot;GCTA.result\u0026quot;)\rsystem(paste0(\u0026quot;./gcta64 --reml-bivar --grm \u0026quot;,\rgeno.file,\u0026quot; --pheno \u0026quot;, pheno.file,\r\u0026quot; --thread-num 20 --out \u0026quot;, output.file ))\r}\r When the simulated errors have no covariance, we could specify \u0026ndash;reml-bivar-nocove for fair comparison. To test for the non-zero genetic covariance, ** \u0026ndash;reml-bivar-lrt-rg 0 ** could be used.\nSimuGCTA.test = function(geno.file, pheno.file, output.dir){\routput.file = paste0(output.dir, \u0026quot;GCTA.result\u0026quot;)\rsystem(paste0(\u0026quot;./gcta64 --reml-bivar-nocove --reml-maxit 100 --grm \u0026quot;, geno.file,\u0026quot; --pheno \u0026quot;,\rpheno.file,\u0026quot; --reml-bivar-lrt-rg 0 --out \u0026quot;,output.file))\r}\r Read GCTA output file\nread.GCTA = function(output.dir, LRT = T){\rfilename = paste0(output.dir, \u0026quot;GCTA.result.hsq\u0026quot;)\rif(file.exists(filename)){\rhsq = data.table::fread(filename, fill = T)\rEst = as.vector(t( hsq[1:3, 2:3])) %\u0026gt;% setNames(c(\u0026quot;Heri.1\u0026quot;,\u0026quot;Heri.1.Se\u0026quot;,\u0026quot;Heri.2\u0026quot;,\u0026quot;Heri.2.Se\u0026quot;, \u0026quot;GeCv\u0026quot;,\u0026quot;GeCv.Se\u0026quot; ))\rif(LRT){\rpval = as.numeric(sapply(strsplit(as.character(hsq[hsq$Source == \u0026quot;Pval\u0026quot;,2]), \u0026quot;\\\\(\u0026quot;), \u0026quot;[[\u0026quot;, 1))\r}\r}\rreturn(list(Est = Est, pval = pval))\r}\r LDSC First, we generate the ld score based on the genotype file. This function only need be estimated once\nmodule load ldsc source activate ldsc-1.0.1 ldsc.py \u0026ndash;bfile geno \u0026ndash;ld-wind-cm 1 \u0026ndash;out chr1_select ldsc.py \u0026ndash;bfile ../../Cric_HF_RealData/rawdata/cric.filtered.maf0.01 \u0026ndash;extract ./temp/snplist.txt \u0026ndash;ld-wind-kb 1000 \u0026ndash;out ./temp/geno\nImplement the LDSC regression\nSimuLDSC = function(Z1, N1, Z2, N2, Nc=0, weight=T, CSTR = T,\rinfo = NA, LDSCORE, corenum = 1, output.dir){\rif(length(Z1) != length(Z2) ){stop(\u0026quot;Z scores should have the same length.\u0026quot;)}\rif(!is.na(info)){\rprint(\u0026quot;update info\u0026quot;)\rZ1.data = data.frame(SNP = info$SNP , Z = Z1, N = N1,\rA1 = \u0026quot;A\u0026quot;, A2 = \u0026quot;G\u0026quot;, stringsAsFactors = F)\rcolnames(Z1.data) = c(\u0026quot;SNP\u0026quot;, \u0026quot;Z\u0026quot;, \u0026quot;N\u0026quot;, \u0026quot;A1\u0026quot;, \u0026quot;A2\u0026quot;)\rfwrite(Z1.data, file = paste0(output.dir, \u0026quot;Z1.sumstats\u0026quot;) , quote = F, sep = \u0026quot;\\t\u0026quot;, col.names=T, na = \u0026quot;NA\u0026quot; )\rZ2.data = data.frame(SNP = info$SNP , Z = Z2, N = N2,\rA1 = \u0026quot;A\u0026quot;, A2 = \u0026quot;G\u0026quot;, stringsAsFactors = F)\rcolnames(Z2.data) = c(\u0026quot;SNP\u0026quot;, \u0026quot;Z\u0026quot;, \u0026quot;N\u0026quot;, \u0026quot;A1\u0026quot;, \u0026quot;A2\u0026quot;)\rfwrite(Z2.data, file = paste0(output.dir, \u0026quot;Z2.sumstats\u0026quot;), quote = F, sep = \u0026quot;\\t\u0026quot;, col.names=T, na = \u0026quot;NA\u0026quot; )\r}\rif(weight == T){\rname = paste0(output.dir, \u0026quot;LDSC\u0026quot;)\rsystem(paste0(\u0026quot;ldsc.py --rg \u0026quot;,paste0(J, \u0026quot;Z1.sumstats,\u0026quot;), paste0(J, \u0026quot;Z2.sumstats\u0026quot;),\r\u0026quot; --ref-ld \u0026quot;, LDSCORE,\u0026quot; --w-ld \u0026quot;,LDSCORE,\u0026quot; --intercept-h2 1,1 --out \u0026quot;,name))\r}else{\rstop()\r} }\r read the LDSC output\nread.LDSC = function(output.dir){\rH = fread(paste0(output.dir, \u0026quot;LDSC.log\u0026quot;), fill = T)\rresult.all = rep(NA, 8)\rresult.gecr = unlist(H[(stringr::str_detect(unlist(H), \u0026quot;Genetic Correlation:\u0026quot;))]) %\u0026gt;% str_split(, pattern = \u0026quot; \u0026quot;) %\u0026gt;% unlist()\rresult.heri = unlist(H[(stringr::str_detect(unlist(H), \u0026quot;Total Observed scale h2:\u0026quot;))]) %\u0026gt;% str_split(, pattern = \u0026quot; \u0026quot;) %\u0026gt;% unlist()\rresult.gecov = unlist(H[(stringr::str_detect(unlist(H), \u0026quot;Total Observed scale gencov:\u0026quot;))]) %\u0026gt;% str_split(, pattern = \u0026quot; \u0026quot;) %\u0026gt;% unlist()\rresult.P = unlist(H[(stringr::str_detect(unlist(H), \u0026quot;P:\u0026quot;))]) %\u0026gt;%\rstr_split(, pattern = \u0026quot; \u0026quot;) %\u0026gt;% unlist()\rif(!is.null(result.gecr)){\rresult = as.numeric(unlist(regmatches(result.gecr,gregexpr(\u0026quot;-?\\\\ *[0-9]+\\\\.?[0-9]*(?:[Ee]\\\\ *-?\\\\ *[0-9]+)?\u0026quot;,result.gecr, perl=TRUE))))\rresult.all[1] = result[1]\rresult.all[2] = result[2]\r}\rif(!is.null(result.heri)){\rresult = as.numeric(unlist(regmatches(result.heri,\rgregexpr(\u0026quot;-?\\\\ *[0-9]+\\\\.?[0-9]*(?:[Ee]\\\\ *-?\\\\ *[0-9]+)?\u0026quot;,\rresult.heri, perl=TRUE))))\rresult.all[3] = result[2]\rresult.all[4] = result[3]\rresult.all[5] = result[5]\rresult.all[6] = result[6]\r}\rif(!is.null(result.gecov)){\rresult = as.numeric(unlist(regmatches(result.gecov,\rgregexpr(\u0026quot;-?\\\\ *[0-9]+\\\\.?[0-9]*(?:[Ee]\\\\ *-?\\\\ *[0-9]+)?\u0026quot;,\rresult.gecov, perl=TRUE))))\rresult.all[7] = result[1]\rresult.all[8] = result[2]\rzscore = result[1]/result[2]\rpvalue = 2* (1 - pnorm(abs(zscore)))\r}else{\rpvalue = NA\r}\rreturn( c(GeCv.pv = pvalue, GeCr.pv = as.numeric(result.P[2])) )\r}\r ","date":1637625600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1637686244,"objectID":"a8595135bb60b45ecfd3191757a319d2","permalink":"https://academic-demo.netlify.app/post/simulation-and-analysis-with-r-and-ldsc/","publishdate":"2021-11-23T00:00:00Z","relpermalink":"/post/simulation-and-analysis-with-r-and-ldsc/","section":"post","summary":"My dissertation research always needs to do comparison with the GCTA-GREML and LDSC.Here is an introduction of R analysis with LDSC and GCTA","tags":[],"title":"Simulation and analysis with R and LDSC","type":"post"},{"authors":["Chi-yuan Hsu","Wei Yang","Rishi V. Parikh","Amanda H. Anderson","Teresa K. Chen","Debbie L. Cohen","Jiang He","Madhumita J. Mohanty","James P. Lash","Katherine T. Mills","Anthony N. Muiru","Afshin Parsa","Milda R. Saunders","Tariq Shafi","Raymond R. Townsend","Sushrut S. Waikar","Jianqiao Wang","Myles Wolf","Thida C. Tan","Harold I. Feldman","Alan S. Go"],"categories":[],"content":"","date":1609459200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1642462549,"objectID":"75305902efa14b14c36f137e7836085a","permalink":"https://academic-demo.netlify.app/publication/hsu-2021-race/","publishdate":"2022-01-18T03:25:12.657457Z","relpermalink":"/publication/hsu-2021-race/","section":"publication","summary":"","tags":[],"title":"Race, Genetic Ancestry, and Estimating Kidney Function in CKD","type":"publication"},{"authors":[],"categories":[],"content":"Create slides in Markdown with Wowchemy Wowchemy | Documentation\n Features  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides   Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E   Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)   Math In-line math: $x + y = z$\nBlock math:\n$$ f\\left( x \\right) = ;\\frac{{2\\left( {x + 4} \\right)\\left( {x - 4} \\right)}}{{\\left( {x + 4} \\right)\\left( {x + 1} \\right)}} $$\n Fragments Make content appear incrementally\n{{% fragment %}} One {{% /fragment %}} {{% fragment %}} **Two** {{% /fragment %}} {{% fragment %}} Three {{% /fragment %}}  Press Space to play!\nOne  Two  Three \n A fragment can accept two optional parameters:\n class: use a custom style (requires definition in custom CSS) weight: sets the order in which a fragment appears   Speaker Notes Add speaker notes to your presentation\n{{% speaker_note %}} - Only the speaker can read these notes - Press `S` key to view {{% /speaker_note %}}  Press the S key to view the speaker notes!\n Only the speaker can read these notes Press S key to view    Themes  black: Black background, white text, blue links (default) white: White background, black text, blue links league: Gray background, white text, blue links beige: Beige background, dark text, brown links sky: Blue background, thin dark text, blue links    night: Black background, thick white text, orange links serif: Cappuccino background, gray text, brown links simple: White background, black text, blue links solarized: Cream-colored background, dark green text, blue links   Custom Slide Customize the slide style and background\n{{\u0026lt; slide background-image=\u0026quot;/media/boards.jpg\u0026quot; \u0026gt;}} {{\u0026lt; slide background-color=\u0026quot;#0000FF\u0026quot; \u0026gt;}} {{\u0026lt; slide class=\u0026quot;my-style\u0026quot; \u0026gt;}}   Custom CSS Example Let\u0026rsquo;s make headers navy colored.\nCreate assets/css/reveal_custom.css with:\n.reveal section h1, .reveal section h2, .reveal section h3 { color: navy; }   Questions? Ask\nDocumentation\n","date":1549324800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1549324800,"objectID":"0e6de1a61aa83269ff13324f3167c1a9","permalink":"https://academic-demo.netlify.app/slides/example/","publishdate":"2019-02-05T00:00:00Z","relpermalink":"/slides/example/","section":"slides","summary":"An introduction to using Wowchemy's Slides feature.","tags":[],"title":"Slides","type":"slides"},{"authors":["Yong Chen","Jianqiao Wang","Jessica Chubak","Rebecca A Hubbard"],"categories":[],"content":"","date":1546300800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1642462542,"objectID":"5293ddd05659e2196dee1c1c79bd5686","permalink":"https://academic-demo.netlify.app/publication/chen-2019-inflation/","publishdate":"2022-01-18T03:25:04.838387Z","relpermalink":"/publication/chen-2019-inflation/","section":"publication","summary":"","tags":[],"title":"Inflation of type I error rates due to differential misclassification in EHR-derived outcomes: Empirical illustration using breast cancer recurrence","type":"publication"},{"authors":["Ke Xu","Jianqiao Wang","Rui Pan","Hansheng Wang"],"categories":[],"content":"","date":1546300800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1642462540,"objectID":"083eabc764872c0889697f2611e3447d","permalink":"https://academic-demo.netlify.app/publication/xu-2019-photographic/","publishdate":"2022-01-18T03:25:00.882705Z","relpermalink":"/publication/xu-2019-photographic/","section":"publication","summary":"","tags":[],"title":"Photographic diary: a new estimation approach to PM 2.5 monitoring","type":"publication"},{"authors":null,"categories":null,"content":"","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"d1311ddf745551c9e117aa4bb7e28516","permalink":"https://academic-demo.netlify.app/project/external-project/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/external-project/","section":"project","summary":"An example of linking directly to an external project website using `external_link`.","tags":["Demo"],"title":"External Project","type":"project"},{"authors":null,"categories":null,"content":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"8f66d660a9a2edc2d08e68cc30f701f7","permalink":"https://academic-demo.netlify.app/project/internal-project/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/internal-project/","section":"project","summary":"An example of using the in-built project page.","tags":["Deep Learning"],"title":"Internal Project","type":"project"},{"authors":null,"categories":null,"content":"","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"f26b5133c34eec1aa0a09390a36c2ade","permalink":"https://academic-demo.netlify.app/admin/config.yml","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/admin/config.yml","section":"","summary":"","tags":null,"title":"","type":"wowchemycms"},{"authors":null,"categories":null,"content":"Publications Statistical Methods Miao, Z., Wang, J., Park, K., Kuang, D., \u0026amp; Kim, J. (2025). Depth-corrected multi-factor dissection of chromatin accessibility for scATAC-seq data with PACS. Nature Communications, 16(1), 1-15.\nWang, J., Li, S., and Li, H. (2024). A Regression-based Approach to Robust Estimation and Inference for Genetic Covariance, Journal of the American Statistical Association (Theory and Methods)\nWang, J., Wang, W. and Li, H. (2022). Sparse block signal detection and identification for shared cross-trait association analysis. The Annals of Applied Statistics, 16(2), 866-886.\nWang, J. and Li, H. (2022). Estimation of genetic correlation with summary association statistics. Biometrika, 109(2), 421-438.\nXu, K., Wang, J., Pan, R. and Wang, H., (2019). Photographic diary: a new estimation approach to PM 2.5 monitoring. Statistics and Its Interface, 12(3), 387-395.\nChen, Y., Wang, J., Chubak, J., and Hubbard, R. A. (2019). Inflation of type I error rates due to differential misclassification in EHR‐derived outcomes: Empirical illustration using breast cancer recurrence. Pharmacoepidemiology and drug safety, 28(2), 264-268.\nScientific Collaboration Deo, R., Dubin, R.F., Ren, Y., Murthy, A.C., Wang, J., Zheng, H., Zheng, Z., Feldman, H., Shou, H., Coresh, J. and Grams, M. (2023). Proteomic cardiovascular risk assessment in chronic kidney disease. European Heart Journal, 44(23), 2095-2110.\nDubin, R., Deo, R., Ren, Y., Wang, J., Zheng, Z., Shou, H., Go, A., Parsa, A., Lash, J., Rahman, M., Hsu, C., Weir, M., Chen, J., Anderson, A., Grams, M., Surapaneni, A., Coresh, J., Lee, H., Kimmel, P., Vasan, R., Feldman, H., Segal, M., Ganz, P. (2023). Proteomics of CKD progression in the chronic renal insufficiency cohort. Nature Communication, Accepted.\nHsu, C. Y., Yang, W., Parikh, R. V., Anderson, A. H., Chen, T. K., Cohen, D. L., He, J., Mohanty, M. J., Lash, J. P., Mills, K. T., Muiru, A. N., Parsa, A., Saunders, M. R., Shafi, T., Townsend, R. R., Waikar, S. S., Wang, J., Wolf, M., Tan, T. C., Feldman, H. I., … CRIC Study Investigators (2021). Race, Genetic Ancestry, and Estimating Kidney Function in CKD. The New England journal of medicine, 385(19), 1750–1760. (2022 Top 10 Clinical Research Achievement Awards).\nPreprints \u0026amp; Working Papers Wang, J., Cui, Y. and Su, W. (2025). Two-sample comparison via unsupervised random forest. Submitted.\nWang, J. and Lin, X. Heritability estimation with genetics similarity representation. Submitted.\nWang, J. and Li, H. Large-scale shared-signal detection and identification. Working paper.\n","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"f1d044c0738ab9f19347f15c290a71a1","permalink":"https://academic-demo.netlify.app/research/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/research/","section":"","summary":"Publications Statistical Methods Miao, Z., Wang, J., Park, K., Kuang, D., \u0026amp; Kim, J. (2025). Depth-corrected multi-factor dissection of chromatin accessibility for scATAC-seq data with PACS. Nature Communications, 16(1), 1-15.","tags":null,"title":"","type":"page"}]